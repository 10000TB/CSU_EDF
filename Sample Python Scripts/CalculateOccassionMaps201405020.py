import arcpy
from arcpy.sa import *
from arcpy import env

# list of dates for Fort Collins for mapping, minus the test days
#lstCFADS2274 = [20121112, 20121113, 20121115, 20121116, 20121119, 20121120, 20121121, 20121126, 20121127, 20121128, 20121129, 20121218, 20121221, 20131007, 20131008, 20131009 ]
#lstCFADS2274 = [20121218, 20121221, 20131007, 20131008, 20131009 ]
#lstCFADS2280 = [20121218,20130107, 20130108, 20130930, 20131001, 20131002, 20131003, 20131007, 20131008, 20131009, 20131010, 20131011, 20131015, 20131015, 20131105, 20131220, 20131227, 20140108, 20140130, 20140225, 20140227, 20140228, 20140303, 20140305, 20140306, 20140310, 20140312, 20140313, 20140317, 20140318, 20140325, 20140326, 20140327, 20140331, 20140401, 20140402, 20140403, 20140404, 20140407, 20140408]
#lstCFADS2280 = [20140225, 20140227, 20140228, 20140303, 20140305, 20140306, 20140310, 20140312, 20140313, 20140317, 20140318, 20140325, 20140326, 20140327, 20140331, 20140401, 20140402, 20140403, 20140404, 20140407, 20140408]

#list of dates for Indy
#lstCFADS2274 = [20130610, 20130611, 20130612, 20130613]
#lstCFADS2274 = [20130610, 20130613]
#lstCFADS2280 = [20130610, 20130611, 20130613, 20130614, 20130617, 20130618, 20130619, 20130620, 20130621, 20130624, 20130625, 20130626, 20130627, 20130628, 20130701, 20130702]
#lstCFADS2280 = [20130610, 20130613, 20130614, 20130617, 20130618, 20130620, 20130621, 20130625, 20130627, 20130628, 20130701]

#list of dates for Boston
#lstCFADS2274 = [20130307, 20130311, 20130312, 20130313, 20130314, 20130315, 20130318, 20130320, 20130321, 20130322, 20130325, 20130327, 20130328, 20130401, 20130402, 20130404, 20130405, 20130408, 20130409, 20130411, 20130415, 20130416, 20130423, 20130424, 20130425, 20130426, 20130503, 20130506, 20130507, 20130508, 20130509, 20130510, 20130513, 20130514, 20130515, 20130516, 20130520, 20130521, 20130523, 20130524, 20130528, 20130529, 20130530, 20130531, 20130604, 20130605, 20130606]
#lstCFADS2276 = [20130307, 20130311, 20130312, 20130313, 20130314, 20130315, 20130318, 20130319, 20130320, 20130322, 20130325, 20130326, 20130327, 20130328, 20130329, 20130401, 20130402, 20130403, 20130411, 20130417, 20130418, 20130419, 20130422, 20130423, 20130424, 20130426, 20130429, 20130430, 20130501, 20130503, 20130506, 20130507, 20130508, 20130509, 20130510, 20130513, 20130514, 20130515, 20130516, 20130603, 20130604, 20130605, 20130606, 20130607, 20130610, 20130611, 20130612, 20130613, 20130614, 20130617, 20130618, 20130619, 20130620, 20130621, 20130624, 20130625, 20130626 ]
#lstCFADS2280 = [20130301,20130304,20130306,20130307,20130312,20130314,20130502,20130503,20130506,20130507,20130508,20130509,20130510,20130513,20130514,20130606 ]

#list of dates for Staten Island
#lstCFADS2276 = [20131125, 20131126, 20131202, 20131203, 20131204, 20131205, 20131211, 20131212, 20131213, 20131216, 20131218, 20131219, 20131220, 20131227, 20140115, 20140116, 20140117, 20140120, 20140127, 20140128, 20140130, 20140131, 20140206, 20140207, 20140208, 20140210, 20140211, 20140212, 20140214, 20140217, 20140219, 20140220, 20140304, 20140305, 20140306, 20140307, 20140310, 20140311, 20140312, 20140313, 20140317, 20140318, 20140319, 20140320, 20140321, 20140324, 20140325, 20140327, 20140328, 20140331, 20140401, 20140403, 20140407, 20140410, 20140411, 20140414 ]

#list of dates for Texas
lstCFADS2276 = [20131015, 20131016, 20131017, 20131018, 20131021, 20131022, 20131023, 20131024, 20131025, 20131028, 20131029] 

#NEED TO MODIFY: sDir, sObs, sCity and uncomment appropriate #for

#lstCFADS2274 = [20121112, 20121113, 20121115]
#for loop
sDir = "C:/Data/Texas/ProcessedData_140721/"
sObs = "CFADS2276_"
gSample = "gS"
sCity = "TEX_"

#for i in lstCFADS2274:
for i in lstCFADS2276:
#for i in lstCFADS2280:
    fnIn = sDir + sObs + str(i)
    fnOut = sDir + sCity + sObs + str(i)
    print fnIn + " observations..."
    
    #make observations shapefiles
    arcpy.MakeXYEventLayer_management(fnIn + "_dat.csv","GPS_ABS_LONG","GPS_ABS_LAT",sObs + "O","GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]];-400 -400 1000000000;-100000 10000;-100000 10000;8.98315284119522E-09;0.001;0.001;IsHighPrecision","#")
    arcpy.FeatureToPoint_management(sObs + "O", fnOut + ".shp","CENTROID")

    #calculate time period (every 5 minutes is a new one...)
    arcpy.AddField_management(fnOut + ".shp","Period5Min","LONG","#","#","#","#","NULLABLE","NON_REQUIRED","#")
    arcpy.CalculateField_management(fnOut + ".shp","Period5Min","([EPOCH_TIME] - 1350000000) / (60 * 5)","VB","#")# convert to point at very fine resolution to allow different passes to pop through by chance

#THEN USE MANUAL MERGE OF NEWLY CREATED SHAPE FILES    
